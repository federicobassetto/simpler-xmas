# A Simpler Xmas – Full Project Specification

You are an expert full‑stack engineer. Create and maintain a **single Next.js application** that implements everything in this document.

The goal is to build **“A Simpler Xmas”**, a small product that helps people design a calmer, more mindful Christmas using an AI‑generated, personalised two‑week advent‑style plan.

## 1. Tech Stack and Project Setup

Use the latest stable versions of:

- **Next.js** with the **App Router**.
- **TypeScript** everywhere.
- **React Server Components** where appropriate; use client components only for interactive flows.
- **Tailwind CSS** for styling with a small custom theme.
- **Drizzle ORM** with a **SQLite** database stored locally.
- **OpenAI Agents SDK for TypeScript** (`@openai/agents`) and `zod` for structured AI outputs.
- Node 20+.

Project setup:

1. Scaffold a new Next.js app (TypeScript, App Router, Tailwind).
2. Add Drizzle and configure a schema with SQLite.
3. Add the OpenAI Agents SDK and `zod`.
4. Use `pnpm` or `npm` consistently across all scripts.
5. Add `.env.local` support with at least:
   - `OPENAI_API_KEY=...`

Create a top‑level `README.md` documenting stack, setup, and hackathon requirements.

## 2. Product Concept and Tone

Overall theme: **mindful, warm, minimal Christmas**.

Key ideas (inspired by the notes):

- Help people create a **simpler** and **more present** holiday season.
- Focus on **sharing**, **mindfulness**, and **mental wellbeing**.
- Emphasise **low‑stress**, **low‑consumerism** activities:
  - Simple recipes / homemade gifts (e.g. biscuits).
  - Visualisations and meditations.
  - Decluttering and making space for what really matters.
  - Journaling prompts.
  - Outdoor / nature activities.
  - Reuse / recycled gifts.
  - Decorating the tree with natural elements.
  - Things that are good for your heart.

Visual style:

- Minimal layout with plenty of white/cream space.
- Warm palette (soft beige background, muted green, terracotta accent).
- Gentle micro‑animations (fade‑ins, hover states), but nothing flashy.
- Typography: one clean sans‑serif + one gentle serif for headings.

Voice & copy:

- Calm, encouraging, non‑judgmental.
- Recognise that **Christmas is a time for reconnection**.
- Focus on “healthy season” and mental wellbeing, not perfection.

## 3. User Flow Overview

Implement a linear flow:

1. **Landing page** (`/`)
   - Hero with title **“A Simpler Xmas”**.
   - Short subtitle: e.g. “Two weeks of small, kind moments for a calmer Christmas.”
   - Single primary button **“Begin”** that navigates to the next step.
   - No nav bar or other sections for now.

2. **Initial wish page** (`/wish`)
   - Heading: **“For Christmas I would like to…”**
   - Large multiline text area where the user can freely describe what they desire for this season (can be in any language).
   - Helper text suggesting examples like:
     - “Less rushing and more quiet dinners.”
     - “To feel connected with loved ones.”
     - “To spend more time in nature.”
   - A primary button **“Continue”**.
   - On submit:
     - Create a new `Session` in the database.
     - Store the initial free‑text wish.
     - Redirect to a dynamic route: `/questions/[sessionId]`.

3. **Adaptive question flow** (`/questions/[sessionId]`)
   - Purpose: ask **5 follow‑up questions**, one at a time, generated by an AI agent using the OpenAI Agents SDK.
   - The questions refine what the user truly needs for a “simpler Xmas”.
   - Each question has an associated **input type**:
     - `text` (free text).
     - `single-select` (radio buttons).
     - `multi-select` (checkbox / pill toggles).
   - UI elements:
     - Display step info, e.g. “Question 2 of 5”.
     - Render the correct form field type based on metadata.
     - Next button disabled until the user has answered.
     - Gentle progress bar across the top.

   Behaviour:

   - On first load, call a server endpoint to fetch or generate the **next question** for the given session.
   - After the user answers and submits:
     - Persist the answer to the database.
     - Ask the server for the next question.
     - Move forward until 5 questions have been answered.
   - Once all 5 are complete, the server triggers the plan generation (see section 5) and the client navigates to `/plan/[sessionId]`.

4. **Plan page / advent‑style calendar** (`/plan/[sessionId]`)
   - Represents a **two‑week plan** leading up to Christmas: 14 days of small activities aligned with the user’s wish and answers.
   - Layout:
     - Intro section summarising the user’s wish in one sentence (mirrored back via AI, but gently rephrased).
     - Grid of 14 “day cards” (2 or 3 columns) styled like a minimalist advent calendar.
     - Each card shows:
       - Day label, e.g. “Day 1”, “Day 2”.
       - The calendar date relative to **this year’s upcoming 25 December**.
       - Short activity title.
       - A short excerpt from the description.
       - A small tag such as “Self‑care”, “Connection”, “Decluttering”, “Nature”, “Giving”.
     - A right‑hand or below‑the‑fold panel for **“Today’s focus”**:
       - Highlights the activity for today’s date (if within the 14‑day window).
       - Shows the full description, recommended time and estimated minutes.
       - Displays one inspirational quote (see external data section).

   - At the bottom, include a simple optional **email capture**:
     - Heading: “Send this plan to your inbox”.
     - Email input + “Save email” button.
     - For this first version, just store the email on the `Session` in the database; no actual scheduled emailing is required yet.
     - Show a small note: “Daily emails are a future feature. For now, your email is stored locally on this machine.”

## 4. Data Model (Drizzle + SQLite)

Create Drizzle models something like the following, and adjust as needed:

```drizzle
model Session {
  id             String      @id @default(cuid())
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
  christmasWish  String
  email          String?     @unique
  questions      Question[]
  dailyTasks     DailyTask[]
}

model Question {
  id          String    @id @default(cuid())
  sessionId   String
  session     Session   @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  index       Int       // 1..5
  text        String
  inputType   String    // 'text' | 'single-select' | 'multi-select'
  optionsJson String?   // JSON stringified string[]
  answers     Answer[]
  createdAt   DateTime  @default(now())
}

model Answer {
  id         String   @id @default(cuid())
  questionId String
  question   Question @relation(fields: [questionId], references: [id], onDelete: Cascade)
  valueJson  String   // JSON string; can represent a string or string[]
  createdAt  DateTime @default(now())
}

model DailyTask {
  id          String   @id @default(cuid())
  sessionId   String
  session     Session  @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  dayIndex    Int      // 1..14
  targetDate  DateTime // concrete calendar date for that year's lead-up
  title       String
  description String
  category    String   // 'self-care' | 'connection' | 'decluttering' | ...
  tags        String?  // JSON stringified string[]
  quoteText   String?
  quoteAuthor String?
  isCompleted Boolean  @default(false)
}
````

Run migrations to create the SQLite database.

## 5. AI: Question Agent and Plan Agent (OpenAI Agents SDK)

### 5.1 Question Agent – dynamic follow‑up questions

Use the **OpenAI Agents SDK** for TypeScript.

Create a `lib/agents.ts` (or similar) that exports two agents.

For the **question agent**:

- Import from `@openai/agents` and `zod`.
- Define a `questionOutput` Zod schema such as:

```ts
const questionOutput = z.object({
  questionId: z.string(),   // can be a short semantic id; the DB will have its own cuid
  questionText: z.string(),
  inputType: z.enum(['text', 'single-select', 'multi-select']),
  options: z.array(z.string()).optional()
});
```

- Create an agent instance:

```ts
export const questionAgent = new Agent({
  name: 'SimplerXmasQuestionAgent',
  model: 'gpt-5.1',
  instructions: `
You are a warm, practical seasonal coach helping someone design a calmer, simpler holiday period.

You will be called several times in the same session. Each time you respond you must produce exactly ONE follow‑up question plus metadata for how it should be answered.

GENERAL GOAL
- Help the user clarify what they truly need from this season so that another agent can later design a personalised two‑week plan.
- Build on the user's initial wish and on everything they have already shared.
- Aim for a maximum of five questions in total across the session. If you already have enough information, use remaining questions to gently prioritise or clarify.

TONE & SENSITIVITY
- Sound like a kind, grounded friend: calm, practical, never preachy.
- Christmas and the holidays can be stressful, lonely, or painful. Acknowledge this implicitly with gentle language, but do not offer therapy or clinical advice.
- Avoid assumptions: do not assume they celebrate Christmas, have a partner, children, big family, or lots of money. If they reference another celebration, mirror their language (e.g. "holiday season", "New Year", etc.).
- Match the user's language when possible. If their wish and answers are mostly in a non‑English language, ask the next question in that language.

WHAT TO UNCOVER
Across all questions, try to understand:
- What currently drains their energy or makes this season hard (obligations, family tension, travel, work, loneliness, etc.).
- What gives them comfort, rest, or joy.
- How they relate to gifts, expectations, social events, alone time, and traditions.
- Their preferences for practical activities: cooking or baking, crafting or DIY, time in nature, journaling, meditation/relaxation, tidying/decluttering, connecting with others, giving to others, or digital breaks.
- Any constraints: time, energy, money, mobility, caregiving responsibilities, hosting duties, etc.

QUESTION STYLE
- Ask one clear question at a time. The "questionText" must be directly answerable, with no explanations or follow‑up inside it.
- Prefer open questions starting with "what", "how", or "when" over yes/no questions. If the input type is a select, the stem can still be open (e.g. "Which of these feels most true for you right now?").
- Keep questions short and concrete. Avoid abstract coaching jargon.
- Do not reference the number of the question ("first question", "question 3", etc.). The UI handles numbering.

CHOOSING inputType
You must choose the "inputType" that best fits the information you need:

- Use "text" when:
  - You need nuance, feelings, or context.
  - You are exploring something sensitive, like stress, loneliness, or boundaries.
  - Example: "In a few words, what has made past holidays feel heavy or tiring for you?"

- Use "single-select" when:
  - You want the user to pick the one option that fits best.
  - Provide 3–6 concise, mutually distinct options plus an "Other" option when appropriate.
  - Example questionText: "What do you most want to feel during this holiday season?"

- Use "multi-select" when:
  - Several options might apply and variety matters for the later plan.
  - Provide 4–7 options plus "Other" when appropriate.
  - Example questionText: "Which of these small activities sound nourishing to you right now?"

For "single-select" and "multi-select":
- Options should be short, neutral, and inclusive (e.g. "Quiet time alone", "Low‑key time with one or two people", "Fun social gatherings", "I’m not sure yet").
- Do not include overlapping or confusing options.
- Do not encode instructions in the options; they are plain labels.

BOUNDARIES
- Never ask for or infer detailed medical information, diagnoses, medications, or therapy history.
- Never ask for precise financial information, income, or debts.
- Never dig into explicit trauma details or highly intimate topics.
- If the user mentions grief, conflict, or burnout, keep your question gentle and focused on what would help them feel a little safer, calmer, or more supported this season.

Remember: your sole job is to produce the next best question and the appropriate input type and options so that another system can later create a personalised, low‑pressure plan.
  `,
  outputType: questionOutput,
});

```

Implement a helper `generateNextQuestion(session)` that:

- Reads the session’s `christmasWish` plus all existing questions/answers from the DB.
- Constructs a concise prompt string summarising:

  - The initial wish.
  - Previous question/answer pairs.
  - The index of the next question (1–5).
- Calls `run(questionAgent, prompt)`.
- Persists the returned question in the DB with the correct `index` and options JSON.
- Returns the saved question to the API route.

### 5.2 Plan Agent – two‑week advent‑style plan

For the **plan agent**:

- Define a `planOutput` schema, for example:

```ts
const dailyTaskSchema = z.object({
  dayIndex: z.number().int().min(1).max(14),
  title: z.string(),
  description: z.string(),
  category: z.enum(['self-care','connection','decluttering','giving','nature','reflection']),
  tags: z.array(z.string()).optional()
});

const planOutput = z.object({
  summarySentence: z.string(),  // one-line reflection of the user's wish
  days: z.array(dailyTaskSchema).length(14)
});
```

- Create a `PlanAgent` configured roughly like:

```ts
export const planAgent = new Agent({
  name: 'SimplerXmasPlanAgent',
  model: 'gpt-5.1',
  instructions: `
You create a two‑week advent‑style plan that helps someone live a calmer, more mindful holiday season.

INPUT YOU RECEIVE
- A short description of the user's initial wish for this season.
- Up to five question/answer pairs that capture their needs, preferences, and constraints.
- A list of inspirational wellness quotes (text + author) from an external API.

OUTPUT SCHEMA
You must follow the provided structured output type:
- summarySentence: one warm sentence that reflects back what this person is really hoping for.
- days: exactly 14 daily activities with fields such as dayIndex, title, description, category, and tags.
The system will handle dates separately; assume dayIndex 1 is the first day of the two‑week period.

OVERALL GOAL
- Design 14 gentle, practical actions that move the user closer to their wish without overwhelming them.
- The plan should feel like a soft companion: realistic for low energy, low budget, and imperfect circumstances.

TONE & VOICE
- Warm, encouraging, quietly hopeful. Never guilt‑tripping.
- Use simple language and short sentences (2–4 sentences per description).
- Write in the second person ("Today, you will…").
- Match the user's language when possible; if their wish and answers are mostly in a non‑English language, write the plan in that language.
- Assume the holidays can be emotionally mixed. It's okay to acknowledge this gently, but do not give clinical or diagnostic advice.

DESIGN PRINCIPLES
- Favour small, doable steps over big projects. Many tasks should comfortably fit within 10–30 minutes; some can be even shorter.
- Assume limited budget. Most activities should be free or very low‑cost.
- Mix categories across the 14 days so the plan feels varied and balanced:
  - self-care (rest, soothing, mindful breaks)
  - connection (small, authentic moments with others or with community)
  - decluttering (physical or digital, light and focused)
  - giving (acts of kindness, low‑cost gifts, volunteering in gentle ways)
  - nature (walks, fresh air, natural decorations)
  - reflection (journaling, gratitude, intention setting, visualisations)
- Keep activities inclusive and non‑religious by default, unless the user clearly expresses spiritual or religious preferences. If they do, you may respectfully weave those in.

WORKING WITH USER CONSTRAINTS
- Pay attention to everything the user has said about energy, time, money, relationships, and living situation.
- If they mention being overwhelmed, lonely, grieving, or in conflict, respond with extra softness:
  - Offer options that reduce pressure, create small pockets of comfort, or give gentle structure.
- If they mention hosting, caregiving, parenting, travel, or work shifts, design tasks that fit realistically around those responsibilities.
- If they dislike a certain type of activity (e.g. cooking, social gatherings), avoid centering the plan on that.

STRUCTURE OF THE 14 DAYS
- Let the plan have a light arc:
  - Early days: reflection, noticing needs, small decluttering or preparation steps.
  - Middle days: connection, creativity, and nature‑based activities.
  - Final days: boundaries, rest, and meaningful tiny rituals that align with their wish.
- Each day should have ONE primary activity. It may optionally suggest a very tiny "if this is all you can manage" alternative in the same description.
- Repetition is okay in spirit (e.g. several quiet walks), but vary the details and focus so each day feels intentional, not copy‑pasted.

USING QUOTES AS AN EXTERNAL DATA SOURCE
- You are given a list of inspirational quotes with authors.
- Use the themes, moods, and ideas from these quotes as subtle inspiration for the activities.
- Do NOT reproduce any quote verbatim.
- Do NOT reference the quote API or say that your ideas come from quotes.
- The system will store one quote alongside each activity separately; you do not need to mention quotes directly in the text.

SAFETY & BOUNDARIES
- Do not give medical, financial, or legal advice.
- Do not suggest activities that are risky, illegal, extreme, or likely to cause harm.
- Avoid alcohol, drugs, restrictive dieting, or anything that could be unsafe for someone with unknown health conditions.
- Focus on gentle movement, rest, connection, creativity, and reflection that a wide range of adults could do safely at home or nearby.

CATEGORIES & TAGS
- Ensure the "category" for each day matches the content of the description.
- Use tags to highlight key themes (e.g. ["quiet-evening", "journaling"], ["nature", "movement"], ["connection", "low-pressure"]).
- Across 14 days, include every main category at least twice, unless the user's answers clearly reject a category.

Your goal is to deliver a plan that feels like a kind, realistic companion for the next two weeks, helping this person move a little closer to the holiday season they actually want.
  `,
  outputType: planOutput,
});

```

Implement `generatePlan(sessionId)` that:

1. Fetches the `Session` with its questions and answers from the database.
2. Fetches **14 inspirational quotes** from the external data source (see section 6) and keeps them in memory.
3. Constructs a compact input for the agent including:

   - The initial wish.
   - The list of Q&A pairs.
   - The quotes (as an array of `{quote, author}`), with an instruction that the agent may draw on their themes.
4. Calls `run(planAgent, inputStringOrJSON)`.
5. Persists each day into `DailyTask` rows:

   - Compute the **target date** for each `dayIndex` as the 14 days leading up to the next upcoming December 25.
   - Attach one of the fetched quotes to each task.
6. Return the saved tasks (plus `summarySentence`) via the API.

## 6. External Data Source and AI on Top of Data

Use **ZenQuotes.io** as the external data source for inspirational quotes.

Implementation:

- Add a server‑side helper in `lib/quotes.ts` that fetches quotes using `fetch` from `https://zenquotes.io/api/random?count=14` (or similar).
- Parse the JSON into `{ quote: string; author: string }[]`.
- Use this helper inside `generatePlan`.
- For each `DailyTask`, store one quote and author.
- When rendering the **Today’s focus** section on the plan page, show the quote beneath the activity with small text “Quote from ZenQuotes.io”.

AI functionality on top of this data:

- The **Plan Agent** receives the quotes as part of its context and is instructed to draw themes from them when writing the descriptions.
- The description may echo ideas (e.g. “focus on what matters now”) but should avoid copying any quote verbatim.
- This demonstrates AI‑powered transformation of external data into personalised content.

## 7. API Design (Next.js App Router)

Create server routes under `app/api`:

1. `POST /api/session`

   - Body: `{ wishText: string }`.
   - Creates a `Session` with the given wish.
   - Returns `{ sessionId: string }`.

2. `GET /api/questions/next?sessionId=...`

   - Reads how many questions already exist for this session.
   - If fewer than 5:

     - Calls `generateNextQuestion(session)`.
     - Returns `{ done: false, question: { id, index, text, inputType, options } }`.
   - If already 5:

     - Returns `{ done: true }`.

3. `POST /api/questions/answer`

   - Body: `{ sessionId: string; questionId: string; answer: string | string[] }`.
   - Saves an `Answer` row.
   - If this was the 5th answer:

     - Triggers `generatePlan(sessionId)` (if a plan does not yet exist).
     - Returns `{ done: true }`.
   - Otherwise:

     - Returns `{ done: false }`.

4. `GET /api/plan?sessionId=...`

   - If no `DailyTask` rows exist for this session, generates the plan.
   - Returns:

     - `{ summarySentence: string; tasks: DailyTaskDTO[] }`, where each task DTO contains dayIndex, targetDate, title, description, category, tags, quoteText, quoteAuthor, isCompleted.

5. `POST /api/email`

   - Body: `{ sessionId: string; email: string }`.
   - Basic email validation.
   - Saves or updates `Session.email`.
   - Returns a success flag.
   - No real email sending for now; just a TODO comment for future integration (e.g. Resend or similar).

All handlers must be server‑side (no `edge` runtime required).

## 8. Frontend Pages and Components

### 8.1 Layout and shared components

- Use `app/layout.tsx` for a base layout:

  - Set a global background colour (warm off‑white).
  - Global font configuration.
  - Meta tags: title “A Simpler Xmas” and a short description.
- Create a simple `Card` component used for the advent day cards.
- Create a `PrimaryButton` component used across pages.
- Handle mobile and desktop nicely with responsive Tailwind.

### 8.2 Landing page (`app/page.tsx`)

- Centered hero with:

  - Large title “A Simpler Xmas”.
  - Subtitle line about calmer holidays.
  - “Begin” button using `Link` or a client‑side router push.
- Minimal decorative elements: maybe a small line art tree or branch using pure CSS / SVG.

### 8.3 Wish page (`app/wish/page.tsx`)

- Mark as a client component.
- Form with `textarea` and “Continue” button.
- Basic validation: require some non‑empty text.
- On submit:

  - Call `/api/session`.
  - Show loading state while waiting.
  - Navigate to `/questions/[sessionId]`.

### 8.4 Questions page (`app/questions/[sessionId]/page.tsx`)

- Client component.
- On initial load:

  - Fetch the next question via `/api/questions/next`.
  - While loading, show a small warm spinner and message.
- Display:

  - Step indicator (e.g. “Step 2 of 6” or “Question 1 of 5”).
  - Question text.
  - Proper input component:

    - `text`: textarea or input.
    - `single-select`: vertical radio group or segmented buttons.
    - `multi-select`: checkboxes or chip buttons.
- When the user submits:

  - Call `/api/questions/answer`.
  - Then either fetch the next question or, if `done`, navigate to `/plan/[sessionId]`.
- Handle errors gracefully with inline messages.

### 8.5 Plan page (`app/plan/[sessionId]/page.tsx`)

- Server or client hybrid:

  - It can load the plan via server‑side `fetch` to `/api/plan`, or call directly into `generatePlan`.
  - Render summary + grid of cards.

- Format:

  - Top: heading “Your Simpler Xmas plan”.
  - Subheading with the `summarySentence`.
  - Two‑column layout on desktop:

    - Left: grid of 14 day cards.
    - Right: “Today’s focus” panel.

- Day cards:

  - Show day index, formatted date, title, category tag.
  - On click, mark that task as selected in local state and show it in the “Today’s focus” panel.

- “Today’s focus” panel:

  - Show either the current calendar day’s task (if within range) or the first day as default.
  - Full description.
  - The inspirational quote and author, with small “Quote from ZenQuotes.io”.
  - Optional “Mark as done” checkbox that only toggles local UI (DB persistence of `isCompleted` is nice but optional).

- At the bottom:

  - Email capture form as described above.

## 9. Styling Details

Implement a small Tailwind theme:

- Background: something like `#fdf6ec` or Tailwind’s `bg-orange-50`.
- Primary accent: soft terracotta.
- Secondary accent: muted forest green.
- Rounded corners on cards and buttons.
- Use subtle shadows for cards; no harsh borders.
- Add focus states and proper `:hover` behaviour for accessibility.

Avoid clutter; keep it simple and calm.

## 10. README and Notes

Create a clear `README.md` that includes:

- Short product description and screenshots (if possible).
- How to run locally:

  - Install dependencies.
  - Set `OPENAI_API_KEY` in `.env.local`.
  - Run `npx prisma migrate dev`.
  - Run the dev server.
- Brief overview of architecture.
